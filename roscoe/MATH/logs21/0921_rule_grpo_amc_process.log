[2025-09-24 02:00:20] 开始处理：0921_rule_grpo_amc（日志：/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/logs21/0921_rule_grpo_amc_process.log）
[2025-09-24 02:00:20] 0921_rule_grpo_amc：开始清洗
输出文件夹: /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc
读取输入文件: /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/raw21/0921_rule_grpo_amc//raw.json
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/aime24.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/aime24.jsonl，包含 30 条记录
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/math500.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/math500.jsonl，包含 500 条记录
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/amc23.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/amc23.jsonl，包含 40 条记录
处理完成
[2025-09-24 02:00:20] 0921_rule_grpo_amc：开始打分（数据集：aime24）
/root/autodl-tmp/roscoe/ParlAI/parlai/core/opt.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
09/24/2025 02:00:24 - INFO - sentence_transformers.SentenceTransformer -   Use pytorch device_name: cuda:0
09/24/2025 02:00:24 - INFO - sentence_transformers.SentenceTransformer -   Load pretrained SentenceTransformer: all-mpnet-base-v2
Some weights of MPNetModel were not initialized from the model checkpoint at microsoft/mpnet-base and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Evaluating /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_grpo_amc/aime24.jsonl
Batches:   0%|          | 0/55 [00:00<?, ?it/s]Batches:   2%|▏         | 1/55 [00:00<00:22,  2.35it/s]Batches:   7%|▋         | 4/55 [00:00<00:05,  8.55it/s]Batches:  13%|█▎        | 7/55 [00:00<00:03, 13.36it/s]Batches:  20%|██        | 11/55 [00:00<00:02, 19.45it/s]Batches:  27%|██▋       | 15/55 [00:00<00:01, 23.79it/s]Batches:  36%|███▋      | 20/55 [00:01<00:01, 29.22it/s]Batches:  45%|████▌     | 25/55 [00:01<00:00, 34.50it/s]Batches:  56%|█████▋    | 31/55 [00:01<00:00, 41.16it/s]Batches:  67%|██████▋   | 37/55 [00:01<00:00, 42.30it/s]Batches:  85%|████████▌ | 47/55 [00:01<00:00, 56.74it/s]Batches: 100%|██████████| 55/55 [00:01<00:00, 35.43it/s]
Batches:   0%|          | 0/3 [00:00<?, ?it/s]Batches:  33%|███▎      | 1/3 [00:00<00:00,  7.17it/s]Batches: 100%|██████████| 3/3 [00:00<00:00, 15.27it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.42it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.41it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.98it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.96it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 100.47it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 95.19it/s]
Scoring chains ... :   0%|          | 0/30 [00:00<?, ?it/s]We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
`loss_type=None` was set in the config but it is unrecognized. Using the default loss: `ForCausalLMLoss`.
Scoring chains ... :   3%|▎         | 1/30 [02:24<1:09:50, 144.51s/it]Scoring chains ... :   7%|▋         | 2/30 [03:00<37:37, 80.62s/it]   Scoring chains ... :  10%|█         | 3/30 [03:11<21:57, 48.79s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (1247 > 1024). Running this sequence through the model will result in indexing errors
Scoring chains ... :  13%|█▎        | 4/30 [03:30<16:07, 37.19s/it]Scoring chains ... :  17%|█▋        | 5/30 [06:47<39:31, 94.88s/it]Scoring chains ... :  20%|██        | 6/30 [08:44<40:52, 102.18s/it]Scoring chains ... :  23%|██▎       | 7/30 [09:20<30:51, 80.52s/it] Scoring chains ... :  27%|██▋       | 8/30 [10:06<25:34, 69.75s/it]Scoring chains ... :  30%|███       | 9/30 [10:25<18:49, 53.79s/it]Scoring chains ... :  33%|███▎      | 10/30 [11:21<18:09, 54.49s/it]Scoring chains ... :  37%|███▋      | 11/30 [12:27<18:21, 57.95s/it]Scoring chains ... :  40%|████      | 12/30 [12:30<12:24, 41.34s/it]Scoring chains ... :  43%|████▎     | 13/30 [13:16<12:05, 42.70s/it]Scoring chains ... :  47%|████▋     | 14/30 [13:30<09:02, 33.90s/it]Scoring chains ... :  50%|█████     | 15/30 [14:25<10:06, 40.41s/it]Scoring chains ... :  53%|█████▎    | 16/30 [16:23<14:52, 63.78s/it]Scoring chains ... :  57%|█████▋    | 17/30 [22:07<32:03, 147.97s/it]Scoring chains ... :  60%|██████    | 18/30 [23:54<27:07, 135.61s/it]Scoring chains ... :  63%|██████▎   | 19/30 [25:06<21:22, 116.57s/it]Scoring chains ... :  67%|██████▋   | 20/30 [27:24<20:29, 122.92s/it]Scoring chains ... :  70%|███████   | 21/30 [32:04<25:32, 170.25s/it]Scoring chains ... :  73%|███████▎  | 22/30 [32:07<15:58, 119.85s/it]Scoring chains ... :  77%|███████▋  | 23/30 [34:45<15:18, 131.27s/it]Scoring chains ... :  80%|████████  | 24/30 [1:08:02<1:09:07, 691.21s/it]Scoring chains ... :  83%|████████▎ | 25/30 [1:13:03<47:50, 574.19s/it]  Scoring chains ... :  87%|████████▋ | 26/30 [1:13:18<27:05, 406.37s/it]Scoring chains ... :  90%|█████████ | 27/30 [1:14:00<14:50, 296.97s/it]Scoring chains ... :  93%|█████████▎| 28/30 [1:14:16<07:05, 212.63s/it]Scoring chains ... :  97%|█████████▋| 29/30 [1:16:08<03:02, 182.50s/it]Scoring chains ... : 100%|██████████| 30/30 [1:16:40<00:00, 137.50s/it]Scoring chains ... : 100%|██████████| 30/30 [1:16:40<00:00, 153.36s/it]
Scores written to /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/output21/0921_rule_grpo_amc/all-mpnet-base-v2/scores_aime24.tsv
Max GPU Memory Allocated: 439 MB
math500.jsonl
['aime24']
Skipping due to --datasets filter: math500.jsonl
amc23.jsonl
['aime24']
Skipping due to --datasets filter: amc23.jsonl
[2025-09-24 03:17:22] 0921_rule_grpo_amc：打分完成
