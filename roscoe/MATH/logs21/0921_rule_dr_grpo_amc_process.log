[2025-09-24 01:18:38] 开始处理：0921_rule_dr_grpo_amc（日志：/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/logs21/0921_rule_dr_grpo_amc_process.log）
[2025-09-24 01:18:38] 0921_rule_dr_grpo_amc：开始清洗
输出文件夹: /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc
读取输入文件: /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/raw21/0921_rule_dr_grpo_amc//raw.json
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/aime24.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/aime24.jsonl，包含 30 条记录
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/math500.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/math500.jsonl，包含 500 条记录
写入JSONL文件/root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/amc23.jsonl
已生成 /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/amc23.jsonl，包含 40 条记录
处理完成
[2025-09-24 01:18:38] 0921_rule_dr_grpo_amc：开始打分（数据集：aime24）
/root/autodl-tmp/roscoe/ParlAI/parlai/core/opt.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
09/24/2025 01:18:43 - INFO - sentence_transformers.SentenceTransformer -   Use pytorch device_name: cuda:0
09/24/2025 01:18:43 - INFO - sentence_transformers.SentenceTransformer -   Load pretrained SentenceTransformer: all-mpnet-base-v2
Some weights of MPNetModel were not initialized from the model checkpoint at microsoft/mpnet-base and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Evaluating /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/clean21/0921_rule_dr_grpo_amc/aime24.jsonl
Batches:   0%|          | 0/56 [00:00<?, ?it/s]Batches:   2%|▏         | 1/56 [00:00<00:20,  2.66it/s]Batches:   5%|▌         | 3/56 [00:00<00:07,  7.05it/s]Batches:  11%|█         | 6/56 [00:00<00:04, 12.16it/s]Batches:  16%|█▌        | 9/56 [00:00<00:02, 16.36it/s]Batches:  23%|██▎       | 13/56 [00:00<00:01, 22.33it/s]Batches:  30%|███       | 17/56 [00:00<00:01, 26.84it/s]Batches:  39%|███▉      | 22/56 [00:01<00:01, 32.08it/s]Batches:  48%|████▊     | 27/56 [00:01<00:00, 36.64it/s]Batches:  61%|██████    | 34/56 [00:01<00:00, 45.09it/s]Batches:  70%|██████▉   | 39/56 [00:01<00:00, 44.40it/s]Batches:  84%|████████▍ | 47/56 [00:01<00:00, 54.00it/s]Batches: 100%|██████████| 56/56 [00:01<00:00, 63.49it/s]Batches: 100%|██████████| 56/56 [00:01<00:00, 35.03it/s]
Batches:   0%|          | 0/3 [00:00<?, ?it/s]Batches:  33%|███▎      | 1/3 [00:00<00:00,  6.65it/s]Batches: 100%|██████████| 3/3 [00:00<00:00, 14.21it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  4.84it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  4.84it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.60it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  5.60it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 84.37it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 85.58it/s]
Scoring chains ... :   0%|          | 0/30 [00:00<?, ?it/s]We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
`loss_type=None` was set in the config but it is unrecognized. Using the default loss: `ForCausalLMLoss`.
Token indices sequence length is longer than the specified maximum sequence length for this model (1103 > 1024). Running this sequence through the model will result in indexing errors
Scoring chains ... :   3%|▎         | 1/30 [04:33<2:12:14, 273.61s/it]Scoring chains ... :   7%|▋         | 2/30 [05:42<1:11:25, 153.07s/it]Scoring chains ... :  10%|█         | 3/30 [05:53<39:37, 88.07s/it]   Scoring chains ... :  13%|█▎        | 4/30 [06:13<26:32, 61.24s/it]Scoring chains ... :  17%|█▋        | 5/30 [17:33<1:58:29, 284.39s/it]Scoring chains ... :  20%|██        | 6/30 [19:23<1:30:06, 225.29s/it]Scoring chains ... :  23%|██▎       | 7/30 [21:40<1:15:17, 196.43s/it]Scoring chains ... :  27%|██▋       | 8/30 [22:35<55:32, 151.48s/it]  Scoring chains ... :  30%|███       | 9/30 [22:42<37:06, 106.02s/it]Scoring chains ... :  33%|███▎      | 10/30 [23:57<32:09, 96.46s/it]Scoring chains ... :  37%|███▋      | 11/30 [25:20<29:16, 92.44s/it]Scoring chains ... :  40%|████      | 12/30 [25:25<19:43, 65.75s/it]Scoring chains ... :  43%|████▎     | 13/30 [26:19<17:40, 62.38s/it]Scoring chains ... :  47%|████▋     | 14/30 [26:32<12:37, 47.32s/it]Scoring chains ... :  50%|█████     | 15/30 [27:12<11:15, 45.05s/it]Scoring chains ... :  53%|█████▎    | 16/30 [28:26<12:35, 53.94s/it]Scoring chains ... :  57%|█████▋    | 17/30 [30:03<14:27, 66.75s/it]Scoring chains ... :  60%|██████    | 18/30 [31:30<14:34, 72.87s/it]Scoring chains ... :  63%|██████▎   | 19/30 [33:10<14:52, 81.16s/it]Scoring chains ... :  67%|██████▋   | 20/30 [34:25<13:13, 79.32s/it]Scoring chains ... :  70%|███████   | 21/30 [1:09:19<1:42:35, 683.92s/it]Scoring chains ... :  73%|███████▎  | 22/30 [1:09:22<1:03:56, 479.51s/it]Scoring chains ... :  77%|███████▋  | 23/30 [1:10:35<41:42, 357.54s/it]  Scoring chains ... :  80%|████████  | 24/30 [1:11:32<26:44, 267.43s/it]Scoring chains ... :  83%|████████▎ | 25/30 [1:24:29<35:01, 420.25s/it]Scoring chains ... :  87%|████████▋ | 26/30 [1:24:34<19:43, 295.82s/it]Scoring chains ... :  90%|█████████ | 27/30 [1:24:40<10:26, 208.83s/it]Scoring chains ... :  93%|█████████▎| 28/30 [1:24:53<05:00, 150.07s/it]Scoring chains ... :  97%|█████████▋| 29/30 [1:28:09<02:43, 163.68s/it]Scoring chains ... : 100%|██████████| 30/30 [1:28:12<00:00, 115.55s/it]Scoring chains ... : 100%|██████████| 30/30 [1:28:12<00:00, 176.41s/it]
Scores written to /root/autodl-tmp/roscoe/ParlAI/projects/roscoe/MATH/output21/0921_rule_dr_grpo_amc/all-mpnet-base-v2/scores_aime24.tsv
Max GPU Memory Allocated: 439 MB
math500.jsonl
['aime24']
Skipping due to --datasets filter: math500.jsonl
amc23.jsonl
['aime24']
Skipping due to --datasets filter: amc23.jsonl
[2025-09-24 02:47:12] 0921_rule_dr_grpo_amc：打分完成
